{"version":3,"sources":["view_splitter.js"],"names":[],"mappings":"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","file":"src/core/compiler/pipeline/view_splitter.js","sourceRoot":"/Users/justin/workspace/angular2_quckstart/quickstart/node_modules/angular2/es6/prod/","sourcesContent":["import {isBlank,\n  isPresent,\n  BaseException} from 'angular2/src/facade/lang';\nimport {DOM} from 'angular2/src/dom/dom_adapter';\nimport {MapWrapper,\n  ListWrapper} from 'angular2/src/facade/collection';\nimport {Parser} from 'angular2/change_detection';\nimport {CompileStep} from './compile_step';\nimport {CompileElement} from './compile_element';\nimport {CompileControl} from './compile_control';\nimport {StringWrapper} from 'angular2/src/facade/lang';\nexport class ViewSplitter extends CompileStep {\n  constructor(parser) {\n    super();\n    this._parser = parser;\n  }\n  process(parent, current, control) {\n    var attrs = current.attrs();\n    var templateBindings = MapWrapper.get(attrs, 'template');\n    var hasTemplateBinding = isPresent(templateBindings);\n    MapWrapper.forEach(attrs, (attrValue, attrName) => {\n      if (StringWrapper.startsWith(attrName, '*')) {\n        var key = StringWrapper.substring(attrName, 1);\n        if (hasTemplateBinding) {\n          throw new BaseException(`Only one template directive per element is allowed: ` + `${templateBindings} and ${key} cannot be used simultaneously ` + `in ${current.elementDescription}`);\n        } else {\n          templateBindings = (attrValue.length == 0) ? key : key + ' ' + attrValue;\n          hasTemplateBinding = true;\n        }\n      }\n    });\n    if (isBlank(parent)) {\n      current.isViewRoot = true;\n    } else {\n      if (DOM.isTemplateElement(current.element)) {\n        if (!current.isViewRoot) {\n          var viewRoot = new CompileElement(DOM.createTemplate(''));\n          var currentElement = current.element;\n          var viewRootElement = viewRoot.element;\n          this._moveChildNodes(DOM.content(currentElement), DOM.content(viewRootElement));\n          viewRoot.elementDescription = current.elementDescription;\n          viewRoot.isViewRoot = true;\n          control.addChild(viewRoot);\n        }\n      } else {\n        if (hasTemplateBinding) {\n          var newParent = new CompileElement(DOM.createTemplate(''));\n          newParent.elementDescription = current.elementDescription;\n          current.isViewRoot = true;\n          this._parseTemplateBindings(templateBindings, newParent);\n          this._addParentElement(current.element, newParent.element);\n          control.addParent(newParent);\n          DOM.remove(current.element);\n        }\n      }\n    }\n  }\n  _moveChildNodes(source, target) {\n    var next = DOM.firstChild(source);\n    while (isPresent(next)) {\n      DOM.appendChild(target, next);\n      next = DOM.firstChild(source);\n    }\n  }\n  _addParentElement(currentElement, newParentElement) {\n    DOM.insertBefore(currentElement, newParentElement);\n    DOM.appendChild(newParentElement, currentElement);\n  }\n  _parseTemplateBindings(templateBindings, compileElement) {\n    var bindings = this._parser.parseTemplateBindings(templateBindings, compileElement.elementDescription);\n    for (var i = 0; i < bindings.length; i++) {\n      var binding = bindings[i];\n      if (binding.keyIsVar) {\n        compileElement.addVariableBinding(binding.key, binding.name);\n        MapWrapper.set(compileElement.attrs(), binding.key, binding.name);\n      } else if (isPresent(binding.expression)) {\n        compileElement.addPropertyBinding(binding.key, binding.expression);\n        MapWrapper.set(compileElement.attrs(), binding.key, binding.expression.source);\n      } else {\n        DOM.setAttribute(compileElement.element, binding.key, '');\n      }\n    }\n  }\n}\nObject.defineProperty(ViewSplitter, \"parameters\", {get: function() {\n    return [[Parser]];\n  }});\nObject.defineProperty(ViewSplitter.prototype.process, \"parameters\", {get: function() {\n    return [[CompileElement], [CompileElement], [CompileControl]];\n  }});\nObject.defineProperty(ViewSplitter.prototype._parseTemplateBindings, \"parameters\", {get: function() {\n    return [[assert.type.string], [CompileElement]];\n  }});\n//# sourceMappingURL=view_splitter.js.map\n\n//# sourceMappingURL=./view_splitter.map"]}