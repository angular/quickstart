{"version":3,"sources":["xhr_mock.js"],"names":[],"mappings":"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","file":"src/mock/xhr_mock.js","sourceRoot":"/Users/justin/workspace/angular2_quckstart/quickstart/node_modules/angular2/es6/prod/","sourcesContent":["import {XHR} from 'angular2/src/core/compiler/xhr/xhr';\nimport {List,\n  ListWrapper,\n  Map,\n  MapWrapper} from 'angular2/src/facade/collection';\nimport {isBlank,\n  isPresent,\n  normalizeBlank,\n  BaseException} from 'angular2/src/facade/lang';\nimport {PromiseWrapper,\n  Promise} from 'angular2/src/facade/async';\nexport class XHRMock extends XHR {\n  constructor() {\n    super();\n    this._expectations = [];\n    this._definitions = MapWrapper.create();\n    this._requests = [];\n  }\n  get(url) {\n    var request = new _PendingRequest(url);\n    ListWrapper.push(this._requests, request);\n    return request.getPromise();\n  }\n  expect(url, response) {\n    var expectation = new _Expectation(url, response);\n    ListWrapper.push(this._expectations, expectation);\n  }\n  when(url, response) {\n    MapWrapper.set(this._definitions, url, response);\n  }\n  flush() {\n    if (this._requests.length === 0) {\n      throw new BaseException('No pending requests to flush');\n    }\n    do {\n      var request = ListWrapper.removeAt(this._requests, 0);\n      this._processRequest(request);\n    } while (this._requests.length > 0);\n    this.verifyNoOustandingExpectations();\n  }\n  verifyNoOustandingExpectations() {\n    if (this._expectations.length === 0)\n      return ;\n    var urls = [];\n    for (var i = 0; i < this._expectations.length; i++) {\n      var expectation = this._expectations[i];\n      ListWrapper.push(urls, expectation.url);\n    }\n    throw new BaseException(`Unsatisfied requests: ${ListWrapper.join(urls, ', ')}`);\n  }\n  _processRequest(request) {\n    var url = request.url;\n    if (this._expectations.length > 0) {\n      var expectation = this._expectations[0];\n      if (expectation.url == url) {\n        ListWrapper.remove(this._expectations, expectation);\n        request.complete(expectation.response);\n        return ;\n      }\n    }\n    if (MapWrapper.contains(this._definitions, url)) {\n      var response = MapWrapper.get(this._definitions, url);\n      request.complete(normalizeBlank(response));\n      return ;\n    }\n    throw new BaseException(`Unexpected request ${url}`);\n  }\n}\nObject.defineProperty(XHRMock.prototype.get, \"parameters\", {get: function() {\n    return [[assert.type.string]];\n  }});\nObject.defineProperty(XHRMock.prototype.expect, \"parameters\", {get: function() {\n    return [[assert.type.string], [assert.type.string]];\n  }});\nObject.defineProperty(XHRMock.prototype.when, \"parameters\", {get: function() {\n    return [[assert.type.string], [assert.type.string]];\n  }});\nObject.defineProperty(XHRMock.prototype._processRequest, \"parameters\", {get: function() {\n    return [[_PendingRequest]];\n  }});\nclass _PendingRequest {\n  constructor(url) {\n    this.url = url;\n    this.completer = PromiseWrapper.completer();\n  }\n  complete(response) {\n    if (isBlank(response)) {\n      this.completer.reject(`Failed to load ${this.url}`);\n    } else {\n      this.completer.resolve(response);\n    }\n  }\n  getPromise() {\n    return this.completer.promise;\n  }\n}\nObject.defineProperty(_PendingRequest.prototype.complete, \"parameters\", {get: function() {\n    return [[assert.type.string]];\n  }});\nclass _Expectation {\n  constructor(url, response) {\n    this.url = url;\n    this.response = response;\n  }\n}\nObject.defineProperty(_Expectation, \"parameters\", {get: function() {\n    return [[assert.type.string], [assert.type.string]];\n  }});\n//# sourceMappingURL=xhr_mock.js.map\n\n//# sourceMappingURL=./xhr_mock.map"]}